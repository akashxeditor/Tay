<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>ভিডিও লোড হচ্ছে...</title>
    <meta name="description" content="ভিডিও দেখুন">
    
    <meta property="og:title" content="Viral Video">
    <meta property="og:description" content="Watch this video now">
    <meta property="og:image" content="">
    <meta property="og:type" content="video.movie">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        body { background: #121212; color: white; font-family: 'Segoe UI', sans-serif; min-height: 100vh; }
        .video-wrapper {
            background: black;
            width: 100%;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        video { width: 100%; max-height: 50vh; display: block; margin: 0 auto; }
        
        .content-container { max-width: 800px; margin: 0 auto; padding: 20px; }
        
        .video-title { font-size: 22px; font-weight: bold; margin-bottom: 10px; color: #fff; }
        .video-desc { color: #aaa; font-size: 15px; line-height: 1.6; background: #1e1e1e; padding: 15px; border-radius: 8px; margin-top: 15px; }
        
        .btn-download {
            background: #27ae60;
            color: white;
            font-weight: bold;
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
            display: block;
            text-align: center;
            text-decoration: none;
        }
        .btn-download:hover { background: #219150; color: white; }
    </style>
</head>
<body>

    <div class="video-wrapper">
        <video id="mainVideo" controls autoplay playsinline>
            <source src="" type="video/mp4">
            আপনার ব্রাউজার ভিডিও সাপোর্ট করছে না।
        </video>
    </div>

    <div class="content-container">
        <div id="loader" class="text-center mt-3">
            <div class="spinner-border text-light" role="status"></div>
        </div>

        <div id="info-area" style="display: none;">
            <h1 id="videoTitle" class="video-title"></h1>
            
            <a id="downloadBtn" href="#" target="_blank" class="btn-download">
                <i class="fas fa-download me-2"></i> ভিডিও ডাউনলোড করুন
            </a>

            <div class="video-desc">
                <h5 class="text-white mb-2">Description</h5>
                <p id="videoDesc" class="mb-0"></p>
            </div>
            
            <div class="mt-4 text-center">
                <a href="index.html" class="btn btn-outline-light btn-sm">
                    <i class="fas fa-arrow-left me-2"></i> সব ভিডিও দেখুন
                </a>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // আপনার সঠিক কনফিগারেশন
        const firebaseConfig = {
            apiKey: "AIzaSyBvmM0i0oQyqE7OywtuPaNVwCIb3lcR3yA",
            authDomain: "viral-video-2ddb4.firebaseapp.com",
            databaseURL: "https://viral-video-2ddb4-default-rtdb.firebaseio.com",
            projectId: "viral-video-2ddb4",
            storageBucket: "viral-video-2ddb4.firebasestorage.app",
            messagingSenderId: "371603329130",
            appId: "1:371603329130:web:2125f1eb16b6bfb55e7a13",
            measurementId: "G-L4481L78P1"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // URL থেকে ID নেওয়া (যেমন: ?id=-OgXwn...)
        const params = new URLSearchParams(window.location.search);
        const videoId = params.get('id');

        if(videoId) {
            const videoRef = ref(db, 'videos/' + videoId);

            get(videoRef).then((snapshot) => {
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    
                    // --- SEO ম্যাজিক (Google এর জন্য) ---
                    document.title = data.title; // ব্রাউজার ট্যাবের নাম চেঞ্জ হবে
                    
                    // মেটা ডেসক্রিপশন সেট করা
                    const metaDesc = document.querySelector('meta[name="description"]');
                    if(metaDesc) metaDesc.setAttribute("content", data.description);

                    // সোশ্যাল মিডিয়া ট্যাগ আপডেট
                    document.querySelector('meta[property="og:title"]').setAttribute("content", data.title);
                    document.querySelector('meta[property="og:description"]').setAttribute("content", data.description);
                    document.querySelector('meta[property="og:image"]').setAttribute("content", data.thumbnail);
                    // -----------------------------------

                    // প্লেয়ার এবং ইনফো আপডেট
                    const videoEl = document.getElementById('mainVideo');
                    videoEl.src = data.videoUrl;
                    videoEl.poster = data.thumbnail;
                    
                    document.getElementById('videoTitle').innerText = data.title;
                    document.getElementById('videoDesc').innerText = data.description;
                    
                    // ডাউনলোড বাটন
                    const dlBtn = document.getElementById('downloadBtn');
                    if(data.downloadUrl) {
                        dlBtn.href = data.downloadUrl;
                    } else {
                        dlBtn.style.display = 'none'; // ডাউনলোড লিংক না থাকলে বাটন লুকাবে
                    }

                    // লোডার সরিয়ে কন্টেন্ট দেখানো
                    document.getElementById('loader').style.display = 'none';
                    document.getElementById('info-area').style.display = 'block';

                } else {
                    document.body.innerHTML = "<h3 class='text-center mt-5'>ভিডিও পাওয়া যায়নি!</h3>";
                }
            }).catch((error) => {
                console.error(error);
                alert("ডাটা লোড হতে সমস্যা হয়েছে। ইন্টারনেট কানেকশন চেক করুন।");
            });
        } else {
            window.location.href = "index.html";
        }
    </script>
</body>
</html>
